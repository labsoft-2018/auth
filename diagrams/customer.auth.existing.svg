<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="803" height="576" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Title: Customer auth flow - existing user
CustomerMobile->Auth: /sign-in-facebook :facebookToken
Auth->Facebook: Verify token
Facebook->Auth: fbUser
Auth->Credential: get user-id by fbUser.id
Credential->Auth: user-id
Auth->User: get user by user-id
User->Auth: user
Note over Auth: Generate token for user
Auth->CustomerMobile: 200 token]]></source><desc>Customer auth flow - existing user</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><path d="M10,10C278.9,-2.8 253.3,22.8 330.1,10.0C331.4,17.9 328.8,32.5 330.1,43.0C236.5,30.2 278.9,55.8 10.0,43.0C8.7,15.3 11.3,37.7 10.0,10.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="15" y="29" style="font-size: 16px; font-family: danielbd;"><tspan x="15">Customer auth flow - existing user</tspan></text></g><g class="actor"><path d="M10,53C55.6,46.6 115.9,59.4 169.8,53.0C168.1,87.6 171.5,74.8 169.8,96.0C82.4,89.6 61.2,102.4 10.0,96.0C8.3,82.6 11.7,66.9 10.0,53.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="20" y="77" style="font-size: 16px; font-family: danielbd;"><tspan x="20">CustomerMobile</tspan></text></g><g class="actor"><path d="M10,513C45.8,519.4 114.0,506.6 169.8,513.0C168.1,544.5 171.5,539.1 169.8,556.0C35.6,549.6 48.3,562.4 10.0,556.0C11.7,527.1 8.3,521.5 10.0,513.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="20" y="537" style="font-size: 16px; font-family: danielbd;"><tspan x="20">CustomerMobile</tspan></text></g><path d="M89.9,96.0C106.6,446.3 73.2,412.9 89.9,513.0" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M355.0859375,53C382.5,55.5 408.6,50.5 418.8,53.0C417.0,65.3 420.5,63.3 418.8,96.0C382.7,98.5 380.0,93.5 355.1,96.0C353.4,88.5 356.8,85.7 355.1,53.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="365.0859375" y="77" style="font-size: 16px; font-family: danielbd;"><tspan x="365.0859375">Auth</tspan></text></g><g class="actor"><path d="M355.0859375,513C377.4,515.5 403.5,510.5 418.8,513.0C420.5,523.3 417.0,545.7 418.8,556.0C408.6,558.5 371.4,553.5 355.1,556.0C356.8,545.7 353.4,549.1 355.1,513.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="365.0859375" y="537" style="font-size: 16px; font-family: danielbd;"><tspan x="365.0859375">Auth</tspan></text></g><path d="M386.9,96.0C370.2,162.7 403.6,309.2 386.9,513.0" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M465.109375,53C535.9,56.8 545.4,49.2 560.7,53.0C562.4,61.4 559.0,74.0 560.7,96.0C517.3,92.2 505.8,99.8 465.1,96.0C466.8,76.6 463.4,59.9 465.1,53.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="475.109375" y="77" style="font-size: 16px; font-family: danielbd;"><tspan x="475.109375">Facebook</tspan></text></g><g class="actor"><path d="M465.109375,513C545.4,516.8 484.4,509.2 560.7,513.0C562.4,527.4 559.0,523.3 560.7,556.0C537.8,552.2 496.2,559.8 465.1,556.0C466.8,546.9 463.4,522.6 465.1,513.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="475.109375" y="537" style="font-size: 16px; font-family: danielbd;"><tspan x="475.109375">Facebook</tspan></text></g><path d="M512.9,96.0C529.6,162.7 496.2,196.1 512.9,513.0" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M580.703125,53C663.7,57.4 618.1,48.6 689.9,53.0C688.2,83.1 691.6,89.1 689.9,96.0C598.2,91.6 606.9,100.4 580.7,96.0C579.0,85.7 582.4,89.1 580.7,53.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="590.703125" y="77" style="font-size: 16px; font-family: danielbd;"><tspan x="590.703125">Credential</tspan></text></g><g class="actor"><path d="M580.703125,513C606.9,508.6 598.2,517.4 689.9,513.0C688.2,529.8 691.6,529.1 689.9,556.0C670.1,560.4 598.2,551.6 580.7,556.0C582.4,549.1 579.0,521.1 580.7,513.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="590.703125" y="537" style="font-size: 16px; font-family: danielbd;"><tspan x="590.703125">Credential</tspan></text></g><path d="M635.3,96.0C618.6,446.3 652.0,162.7 635.3,513.0" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M709.875,53C763.4,55.5 758.3,50.5 773.5,53.0C775.3,85.7 771.8,80.9 773.5,96.0C737.1,98.5 745.7,93.5 709.9,96.0C711.6,89.1 708.2,66.3 709.9,53.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="719.875" y="77" style="font-size: 16px; font-family: danielbd;"><tspan x="719.875">User</tspan></text></g><g class="actor"><path d="M709.875,513C727.8,515.5 720.3,510.5 773.5,513.0C771.8,519.9 775.3,523.3 773.5,556.0C727.4,558.5 725.2,553.5 709.9,556.0C708.2,530.0 711.6,545.4 709.9,513.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="719.875" y="537" style="font-size: 16px; font-family: danielbd;"><tspan x="719.875">User</tspan></text></g><path d="M741.7,96.0C758.4,318.0 725.0,435.9 741.7,513.0" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="signal"><text x="99.890625" y="123.5" style="font-size: 16px; font-family: danielbd;"><tspan x="99.890625">/sign-in-facebook :facebookToken</tspan></text><path d="M89.9,139.0C137.4,150.9 323.7,127.1 386.9,139.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="396.921875" y="166.5" style="font-size: 16px; font-family: danielbd;"><tspan x="396.921875">Verify token</tspan></text><path d="M386.9,182.0C482.7,187.0 492.7,177.0 512.9,182.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="418.03125" y="209.5" style="font-size: 16px; font-family: danielbd;"><tspan x="418.03125">fbUser</tspan></text><path d="M512.9,225.0C447.3,230.0 492.7,220.0 386.9,225.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="408.98828125" y="252.5" style="font-size: 16px; font-family: danielbd;"><tspan x="404.92578125">get user-id by fbUser.id</tspan></text><path d="M386.9,268.0C446.5,277.9 542.9,258.1 635.3,268.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="481.92578125" y="295.5" style="font-size: 16px; font-family: danielbd;"><tspan x="481.92578125">user-id</tspan></text><path d="M635.3,311.0C595.6,301.1 443.2,320.9 386.9,311.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="484.23828125" y="338.5" style="font-size: 16px; font-family: danielbd;"><tspan x="480.17578125">get user by user-id</tspan></text><path d="M386.9,354.0C520.6,368.2 656.6,339.8 741.7,354.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="545.26953125" y="381.5" style="font-size: 16px; font-family: danielbd;"><tspan x="545.26953125">user</tspan></text><path d="M741.7,397.0C585.7,411.2 656.6,382.8 386.9,397.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="note"><path d="M273.9140625,417C315.2,426.0 362.7,408.0 499.9,417.0C501.2,424.9 498.6,430.9 499.9,450.0C400.1,441.0 310.1,459.0 273.9,450.0C272.6,424.9 275.2,442.1 273.9,417.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="278.9140625" y="436" style="font-size: 16px; font-family: danielbd;"><tspan x="278.9140625">Generate token for user</tspan></text></g><g class="signal"><text x="189.96875" y="477.5" style="font-size: 16px; font-family: danielbd;"><tspan x="189.96875">200 token</tspan></text><path d="M386.9,493.0C315.6,481.1 185.6,504.9 89.9,493.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g></svg>